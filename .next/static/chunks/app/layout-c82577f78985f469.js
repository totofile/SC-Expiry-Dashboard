(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{7075:function(e,t,r){Promise.resolve().then(r.bind(r,2917))},2917:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var n=r(7437);r(8877);var i=r(1516);r(2265);var c=()=>{let{isAuth:e,login:t,logout:r}=(0,i.a)();return(0,n.jsxs)("header",{className:"bg-blue-600 text-white p-4 flex justify-between items-center",children:[(0,n.jsx)("h1",{className:"text-xl  mx-20 ",children:"Azure Application Secret/Certificates Expiry Dashboard"}),e?(0,n.jsx)("button",{onClick:r,className:"bg-white text-blue-600 p-2 rounded",children:"Logout"}):(0,n.jsx)("button",{onClick:t,className:"bg-white text-blue-600 p-2 rounded",children:"Login"})]})},o=()=>(0,n.jsx)("footer",{className:"bg-gray-800 text-white p-4 text-center mt-10 ",children:(0,n.jsx)("p",{children:"\xa9 2024 Exakis-Nelite. All rights reserved."})});function l(e){let{children:t}=e;return(0,n.jsx)(i.H,{children:(0,n.jsxs)("html",{lang:"en",children:[(0,n.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,n.jsxs)("body",{className:"flex flex-col min-h-screen",children:[(0,n.jsx)(c,{}),(0,n.jsx)("main",{children:t}),(0,n.jsx)(o,{})]})]})})}},1516:function(e,t,r){"use strict";r.d(t,{H:function(){return a},a:function(){return u}});var n=r(7437),i=r(2265),c=r(4766),o=r(6504),l={clientId:"daf4c825-110a-4385-a469-916c272ae5c3",authority:"https://login.microsoftonline.com/f43e2fea-8e52-469a-a796-56e4c4bcb1f5/",redirectUri:"http://localhost:3000"};let s=(0,i.createContext)(void 0),a=e=>{let{children:t}=e,[r,a]=(0,i.useState)(!1),u=(0,i.useRef)(null);(0,i.useEffect)(()=>{(async()=>{try{u.current=new c.Lx({auth:{clientId:l.clientId,authority:l.authority,redirectUri:l.redirectUri},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!0}}),await u.current.initialize();let e={scopes:["Directory.Read.All"],account:u.current.getAllAccounts()[0]||void 0};try{let t=await u.current.ssoSilent(e);console.log("SSO Silent successful",t),a(!0)}catch(e){e instanceof o.Ut&&"login_required"===e.errorCode?u.current.getAllAccounts().length>0&&a(!0):console.warn("SSO Silent failed, user interaction required",e)}}catch(e){console.error("MSAL initialization failed",e)}})()},[]);let d=async()=>{console.log("Login button clicked");try{var e;await (null===(e=u.current)||void 0===e?void 0:e.loginPopup({scopes:["Directory.Read.All"]})),console.log("Login successful"),a(!0)}catch(e){console.error("Login failed",e)}},h=async()=>{u.current&&(await u.current.logoutPopup().catch(e=>console.error("Logout failed",e)),a(!1),u.current=null,window.location.reload())};return(0,n.jsx)(s.Provider,{value:{isAuth:r,login:d,logout:h,publicClientAppRef:u},children:t})},u=()=>{let e=(0,i.useContext)(s);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},8877:function(){}},function(e){e.O(0,[404,766,971,23,744],function(){return e(e.s=7075)}),_N_E=e.O()}]);